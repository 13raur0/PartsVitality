# PartsVitality

**マインクラフトに、"Escape from Tarkov"のようなハードコアなダメージ・治療システムを導入するプラグインです。**

PartsVitality は、マインクラフトの標準的な体力システムを完全に刷新し、詳細な部位 HP システムを導入します。このプラグインにより、プレイヤーはより戦術的な思考、慎重な怪我の管理、そして新たなレベルの注意深さをもって戦闘に臨むことを要求されます。

## 主な機能

- **部位 HP システム**: 体力は単一のゲージではなく、「頭」「胴」「脚」「足」の 4 つの部位で個別に管理されます。
- **精密なヒット判定**: Ray Tracing（光線追跡）技術により、攻撃が体のどの部位に当たったかを正確に判定します。ヘッドショットや足を狙う戦術が重要になります！
- **リアルな負傷ペナルティ**:
  - **デバフ効果**: 特定の部位にダメージを受けると、それに応じたデバフ（例：頭部ダメージで吐き気、脚部ダメージで移動速度低下）が発生します。
  - **部位破壊**: 部位の HP が 0 になるとその部位は「破壊」され、リスポーンするまでプレイヤーの最大 HP が減少します。
- **手動治療システム**:
  - **自然回復の無効化**: 満腹度による体力の自動回復は行われません。すべての回復は手動で行う必要があります。
  - **部位ごとの治療**: `config.yml`で設定されたアイテムを使い、インベントリ内で負傷した部位に対応する防具をクリックすることで治療します。
  - **手術による重傷治療**: 「破壊」された部位は、通常のアイテムでは治療できません。特別な「手術」用アイテムで応急処置をすることで、再び通常の治療が可能になります。
- **防具の重要性の向上**:
  - **部位の保護**: 防具は、それが覆う特定の部位の HP を守るという、極めて重要な役割を果たします。
  - **現実的な消耗**: 防具の耐久値は、受けたダメージ量に応じて大きく減少するように設定可能で、防具は管理すべき重要なリソースとなります。
- **高いカスタマイズ性**: 部位 HP、ダメージ倍率、治療アイテム、デバフなど、プラグインのほぼすべての要素を`config.yml`で自由に調整できます。
- **多言語対応**: プレイヤーに表示されるすべてのメッセージは翻訳可能です。デフォルトで英語（`en`）と日本語（`ja`）に対応しています。

## 導入方法

1.  最新の`.jar`ファイルをダウンロードします。
2.  ダウンロードした`PartsVitality-1.0.0.jar`ファイルを、サーバーの`plugins/`フォルダに配置します。
3.  サーバーを再起動またはリロードします。`plugins/PartsVitality/`フォルダ内に、設定ファイル（`config.yml`）と言語ファイル（`messages_en.yml`, `messages_ja.yml`）が自動的に生成されます。

## 設定 (`config.yml`)

`config.yml`ファイルを編集することで、サーバーの難易度やプレイスタイルに合わせて、プラグインの動作を細かく調整できます。

<details>
<summary><strong>クリックしてconfig.ymlの詳細な解説を表示</strong></summary>

```yaml
# 使用する言語を設定します (例: en, ja)
language: "ja"

# 部位ごとの最大HP
parts:
  head:
    max-hp: 20.0
  chest:
    max-hp: 29.0
  # ... 以下同様

# ダメージ計算に関する設定
damage:
  # バニラのハートダメージを、部位ダメージに変換する際の倍率です。
  # 数値を大きくすると、より少ない攻撃で部位が破壊されやすくなり、難易度が上がります。
  damage-multiplier: 5.0
  # ヒット判定の精度。数値を大きくすると負荷は減りますが、精度が落ちます。(推奨: 0.1 ~ 0.5)
  ray-trace-step: 0.1

# 通常の治療に関する設定
healing:
  # 治療にかかる時間（秒）
  duration-seconds: 3
  # ... 効果音などの設定 ...

# 手術（破壊された部位の治療）に関する設定
surgery:
  # 手術にかかる時間（秒）
  duration-seconds: 10
  # 手術によって回復する部位HPの量。1.0に設定すると、部位が使用可能になり、通常の治療ができるようになります。
  restored-hp: 1.0
  # ... 効果音などの設定 ...

# 部位が1つ破壊されるごとに減少する最大体力（2.0 = ハート1個分）
health-penalty-per-broken-part: 5.0

# 通常の治療に使用するアイテムと、その回復量
healing-items:
  IRON_INGOT: 10.0
  GOLD_INGOT: 15.0

# 手術に使用するアイテム（HPが0の部位にのみ使用可能）
surgery-items:
  DIAMOND: true

# 各部位のHPが特定の割合を下回った際に適用されるデバフ効果
debuffs:
  head:
    - threshold: 0.5 # 50%以下
      effect: CONFUSION
      level: 0
  # ... 以下同様

# 耐久値に関する設定
durability:
  # trueにすると、受けた部位ダメージに応じて防具の耐久値が大きく減少します。
  use-custom-durability-damage: true
  # 部位ダメージが「いくら」入るごとに、防具の耐久値を1減らすか設定します。
  # 数値を小さくすると、防具の消耗が激しくなります。0.4は革防具を基準に調整されています。
  damage-per-durability-point: 0.4
```

</details>

## 遊び方

- **体力の確認**: インベントリ内で、いずれかの防具にカーソルを合わせて **Shift + 右クリック** すると、部位 HP 表示モードに切り替わります。防具の耐久値バーが、その部位の HP を示すようになります。もう一度同じ操作をすると元に戻ります。

  !部位 HP 表示の切り替え

- **部位の治療**: 治療アイテム（例：鉄インゴット）をカーソルに持ち、インベントリ内で治療したい部位の防具を**左クリック**します。タイマーが開始され、完了すると部位 HP が回復します。

  !通常の治療プロセス

- **手術の実行**: 部位が破壊された（HP が 0 になった）場合、まず手術アイテム（例：ダイヤモンド）でその部位を治療する必要があります。これにより部位 HP がわずかに回復し、再び通常の治療アイテムが使用可能になります。

  !手術プロセス

## ライセンス

このプラグインは MIT License の下で公開されています。
